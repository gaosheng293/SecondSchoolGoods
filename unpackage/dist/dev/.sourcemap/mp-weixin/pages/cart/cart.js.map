{"version":3,"file":"cart.js","sources":["pages/cart/cart.vue","../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2FydC9jYXJ0LnZ1ZQ"],"sourcesContent":["<!-- pages/cart/cart.vue -->\n<template>\n  <view class=\"cart-page\">\n    <!-- 顶部导航 -->\n    <view class=\"navbar\">\n      <text class=\"title\">购物车</text>\n    </view>\n\n    <!-- 购物车列表 -->\n    <scroll-view scroll-y class=\"cart-list\" v-if=\"cart.length > 0\">\n      <view class=\"cart-item\" v-for=\"(item, index) in cart\" :key=\"item.goodsId\">\n        <!-- 选中 checkbox -->\n        <checkbox :checked=\"item.selected\" @click=\"toggleSelect(index)\" />\n\n        <!-- 商品信息 -->\n        <view class=\"item-info\" @click=\"toDetail(item.goodsId)\">\n          <image :src=\"item.cover\" class=\"cover\" mode=\"aspectFill\" />\n          <view class=\"info\">\n            <text class=\"title\">{{ item.title }}</text>\n            <text class=\"price\">¥{{ item.price }}</text>\n          </view>\n        </view>\n\n        <!-- 数量编辑 -->\n        <view class=\"quantity\">\n          <button @click=\"decreaseQuantity(index)\">-</button>\n          <text>{{ item.quantity }}</text>\n          <button @click=\"increaseQuantity(index)\">+</button>\n        </view>\n\n        <!-- 删除 -->\n        <uni-icons type=\"trash\" size=\"24\" color=\"#ff4757\" @click=\"removeItem(index)\" />\n      </view>\n    </scroll-view>\n\n    <!-- 空购物车提示 -->\n    <view class=\"empty\" v-if=\"cart.length === 0\">\n      <image src=\"/static/empty-cart.png\" class=\"empty-img\" />\n      <text>购物车空空如也，去逛逛吧~</text>\n      <button class=\"go-shop\" @click=\"goHome\">去首页逛逛</button>\n    </view>\n\n    <!-- 底部结算栏 -->\n    <view class=\"bottom-bar\" v-if=\"cart.length > 0\">\n      <checkbox :checked=\"allSelected\" @click=\"toggleAllSelect\">全选</checkbox>\n      <view class=\"total\">\n        <text>合计：</text>\n        <text class=\"price\">¥{{ totalPrice }}</text>\n      </view>\n      <button class=\"settle-btn\" :disabled=\"selectedCount === 0\" @click=\"settle\">结算({{ selectedCount }})</button>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      cart: []  // 购物车列表\n    }\n  },\n\n  computed: {\n    // 计算总价（只算选中商品）\n    totalPrice() {\n      return this.cart.reduce((sum, item) => {\n        return item.selected ? sum + item.price * item.quantity : sum\n      }, 0).toFixed(2)\n    },\n\n    // 计算选中商品数量\n    selectedCount() {\n      return this.cart.reduce((count, item) => {\n        return item.selected ? count + item.quantity : count\n      }, 0)\n    },\n\n    // 是否全选\n    allSelected() {\n      return this.cart.length > 0 && this.cart.every(item => item.selected)\n    }\n  },\n\n  onShow() {\n    // 每次显示页面都从本地存储加载购物车\n    this.cart = uni.getStorageSync('cart') || []\n  },\n\n  methods: {\n    // 单选切换\n    toggleSelect(index) {\n      this.cart[index].selected = !this.cart[index].selected\n      this.updateCart()\n    },\n\n    // 全选切换\n    toggleAllSelect() {\n      const all = !this.allSelected\n      this.cart.forEach(item => { item.selected = all })\n      this.updateCart()\n    },\n\n    // 数量减1\n    decreaseQuantity(index) {\n      if (this.cart[index].quantity > 1) {\n        this.cart[index].quantity -= 1\n        this.updateCart()\n      }\n    },\n\n    // 数量加1\n    increaseQuantity(index) {\n      this.cart[index].quantity += 1\n      this.updateCart()\n    },\n\n    // 删除商品\n    removeItem(index) {\n      uni.showModal({\n        title: '确认删除',\n        content: '确定从购物车删除该商品？',\n        success: (res) => {\n          if (res.confirm) {\n            this.cart.splice(index, 1)\n            this.updateCart()\n            uni.showToast({ title: '已删除', icon: 'none' })\n          }\n        }\n      })\n    },\n\n    // 更新本地存储\n    updateCart() {\n      uni.setStorageSync('cart', this.cart)\n    },\n\n    // 结算（模拟跳转支付页）\n    settle() {\n      if (this.selectedCount === 0) return\n      uni.showToast({ title: '跳转支付...（模拟）', icon: 'none' })\n      // 真实场景：跳转到支付页，传递选中商品\n      // uni.navigateTo({ url: '/pages/pay/pay?items=' + JSON.stringify(selectedItems) })\n    },\n\n    // 去首页\n    goHome() {\n      uni.switchTab({ url: '/pages/index/index' })\n    },\n\n    // 去商品详情\n    toDetail(id) {\n      uni.redirectTo({ url: `/pages/detail/detail?id=${id}` })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.cart-page { height: 100vh; display: flex; flex-direction: column; background: #f5f5f5; }\n\n.navbar { height: 90rpx; background: #fff; display: flex; align-items: center; justify-content: center; font-size: 36rpx; font-weight: bold; border-bottom: 1rpx solid #eee; padding-top: var(--status-bar-height); }\n\n.cart-list { flex: 1; padding: 20rpx; }\n\n.cart-item { display: flex; align-items: center; background: #fff; padding: 20rpx; border-radius: 20rpx; margin-bottom: 20rpx; }\n\n.item-info { flex: 1; display: flex; align-items: center; margin-left: 20rpx; }\n.cover { width: 160rpx; height: 160rpx; border-radius: 10rpx; margin-right: 20rpx; }\n.info { flex: 1; }\n.title { font-size: 30rpx; color: #333; margin-bottom: 10rpx; display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 2; overflow: hidden; }\n.price { font-size: 32rpx; color: #ff4757; font-weight: bold; }\n\n.quantity { display: flex; align-items: center; margin: 0 20rpx; }\n.quantity button { width: 60rpx; height: 60rpx; line-height: 60rpx; padding: 0; background: #f5f5f5; color: #333; border-radius: 30rpx; }\n.quantity text { width: 80rpx; text-align: center; font-size: 32rpx; }\n\n.empty { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #999; font-size: 28rpx; }\n.empty-img { width: 300rpx; height: 300rpx; opacity: 0.6; margin-bottom: 40rpx; }\n.go-shop { margin-top: 40rpx; background: #007AFF; color: #fff; padding: 20rpx 40rpx; border-radius: 50rpx; }\n\n.bottom-bar { height: 120rpx; background: #fff; border-top: 1rpx solid #eee; display: flex; align-items: center; padding: 0 32rpx; position: fixed; bottom: 0; left: 0; right: 0; }\n.total { flex: 1; display: flex; align-items: center; justify-content: flex-end; margin-right: 20rpx; font-size: 32rpx; color: #333; }\n.total .price { color: #ff4757; font-weight: bold; }\n.settle-btn { background: #ff4757; color: #fff; height: 88rpx; line-height: 88rpx; padding: 0 60rpx; border-radius: 88rpx; font-size: 32rpx; }\n.settle-btn[disabled] { background: #ddd; color: #999; }\n</style>","import MiniProgramPage from 'E:/code/wechatDOC/HbUniapp/demoxiaoyuan/pages/cart/cart.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;;AAuDA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,MAAM,CAAI;AAAA;AAAA,IACZ;AAAA,EACD;AAAA,EAED,UAAU;AAAA;AAAA,IAER,aAAa;AACX,aAAO,KAAK,KAAK,OAAO,CAAC,KAAK,SAAS;AACrC,eAAO,KAAK,WAAW,MAAM,KAAK,QAAQ,KAAK,WAAW;AAAA,MAC5D,GAAG,CAAC,EAAE,QAAQ,CAAC;AAAA,IAChB;AAAA;AAAA,IAGD,gBAAgB;AACd,aAAO,KAAK,KAAK,OAAO,CAAC,OAAO,SAAS;AACvC,eAAO,KAAK,WAAW,QAAQ,KAAK,WAAW;AAAA,MAChD,GAAE,CAAC;AAAA,IACL;AAAA;AAAA,IAGD,cAAc;AACZ,aAAO,KAAK,KAAK,SAAS,KAAK,KAAK,KAAK,MAAM,UAAQ,KAAK,QAAQ;AAAA,IACtE;AAAA,EACD;AAAA,EAED,SAAS;AAEP,SAAK,OAAOA,cAAAA,MAAI,eAAe,MAAM,KAAK,CAAC;AAAA,EAC5C;AAAA,EAED,SAAS;AAAA;AAAA,IAEP,aAAa,OAAO;AAClB,WAAK,KAAK,KAAK,EAAE,WAAW,CAAC,KAAK,KAAK,KAAK,EAAE;AAC9C,WAAK,WAAW;AAAA,IACjB;AAAA;AAAA,IAGD,kBAAkB;AAChB,YAAM,MAAM,CAAC,KAAK;AAClB,WAAK,KAAK,QAAQ,UAAQ;AAAE,aAAK,WAAW;AAAA,OAAK;AACjD,WAAK,WAAW;AAAA,IACjB;AAAA;AAAA,IAGD,iBAAiB,OAAO;AACtB,UAAI,KAAK,KAAK,KAAK,EAAE,WAAW,GAAG;AACjC,aAAK,KAAK,KAAK,EAAE,YAAY;AAC7B,aAAK,WAAW;AAAA,MAClB;AAAA,IACD;AAAA;AAAA,IAGD,iBAAiB,OAAO;AACtB,WAAK,KAAK,KAAK,EAAE,YAAY;AAC7B,WAAK,WAAW;AAAA,IACjB;AAAA;AAAA,IAGD,WAAW,OAAO;AAChBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,SAAS;AACf,iBAAK,KAAK,OAAO,OAAO,CAAC;AACzB,iBAAK,WAAW;AAChBA,0BAAG,MAAC,UAAU,EAAE,OAAO,OAAO,MAAM,QAAQ;AAAA,UAC9C;AAAA,QACF;AAAA,OACD;AAAA,IACF;AAAA;AAAA,IAGD,aAAa;AACXA,oBAAAA,MAAI,eAAe,QAAQ,KAAK,IAAI;AAAA,IACrC;AAAA;AAAA,IAGD,SAAS;AACP,UAAI,KAAK,kBAAkB;AAAG;AAC9BA,oBAAG,MAAC,UAAU,EAAE,OAAO,eAAe,MAAM,QAAQ;AAAA,IAGrD;AAAA;AAAA,IAGD,SAAS;AACPA,oBAAAA,MAAI,UAAU,EAAE,KAAK,sBAAsB;AAAA,IAC5C;AAAA;AAAA,IAGD,SAAS,IAAI;AACXA,oBAAG,MAAC,WAAW,EAAE,KAAK,2BAA2B,EAAE,IAAI;AAAA,IACzD;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzJA,GAAG,WAAW,eAAe;"}