{"version":3,"file":"chat.js","sources":["pages/chat/chat.vue","../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2hhdC9jaGF0LnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"chat-page\">\r\n    <!-- 顶部导航栏 -->\r\n    <view class=\"navbar\">\r\n      <view class=\"left\" @click=\"back\">\r\n        <uni-icons type=\"back\" size=\"24\" color=\"#fff\" />\r\n      </view>\r\n      <view class=\"title\">{{ friendNickname || '聊天中' }}</view>\r\n      <view class=\"right\"></view>\r\n    </view>\r\n\r\n    <!-- 消息列表 -->\r\n    <scroll-view\r\n      :scroll-top=\"scrollTop\"\r\n      scroll-y\r\n      class=\"msg-list\"\r\n      @scrolltoupper=\"loadMore\"\r\n      enhanced\r\n      show-scrollbar=\"false\"\r\n    >\r\n      <!-- 加载更多提示 -->\r\n      <view v-if=\"loading\" class=\"loading-tip\">加载中...</view>\r\n      <view v-if=\"noMore\" class=\"loading-tip\">没有更多消息了~</view>\r\n\r\n      <view class=\"msg-item\" v-for=\"msg in messages\" :key=\"msg.id\" :class=\"msg.fromUserId == myId ? 'mine' : 'other'\">\r\n        <!-- 对方头像 -->\r\n        <image v-if=\"msg.fromUserId != myId\" class=\"avatar\" :src=\"friendAvatar || '/static/default-avatar.png'\" mode=\"cover\" />\r\n        \r\n        <!-- 消息气泡 -->\r\n        <view class=\"bubble\" :class=\"msg.fromUserId == myId ? 'my-bubble' : 'other-bubble'\">\r\n          <!-- 图片消息 -->\r\n          <image\r\n            v-if=\"msg.type == 1\"\r\n            :src=\"msg.imageUrl\"\r\n            mode=\"widthFix\"\r\n            class=\"msg-image\"\r\n            @click=\"previewImage(msg.imageUrl)\"\r\n          />\r\n          <!-- 文字消息 -->\r\n          <text v-else class=\"msg-text\">{{ msg.content }}</text>\r\n        </view>\r\n\r\n        <!-- 自己头像 -->\r\n        <image v-if=\"msg.fromUserId == myId\" class=\"avatar\" :src=\"myAvatar || '/static/default-avatar.png'\" mode=\"cover\" />\r\n      </view>\r\n\r\n      <!-- 底部占位 -->\r\n      <view style=\"height: 120rpx;\"></view>\r\n    </scroll-view>\r\n\r\n    <!-- 输入栏 -->\r\n    <view class=\"input-bar\">\r\n      <input\r\n        v-model=\"inputText\"\r\n        placeholder=\"说点什么...\"\r\n        class=\"input\"\r\n        @confirm=\"sendText\"\r\n        confirm-type=\"send\"\r\n      />\r\n      <view class=\"icon-btn\" @click=\"chooseImage\">\r\n        <uni-icons type=\"image\" size=\"28\" color=\"#666\" />\r\n      </view>\r\n      <button\r\n        class=\"send-btn\"\r\n        :class=\"{ active: inputText.trim() }\"\r\n        :disabled=\"!inputText.trim()\"\r\n        @click=\"sendText\"\r\n      >发送</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      myId: 0,              // 当前登录用户ID\r\n      myAvatar: '',\r\n      friendId: 0,          // 聊天对象ID\r\n      friendNickname: '',\r\n      friendAvatar: '',\r\n\r\n      messages: [],         // 消息列表\r\n      inputText: '',\r\n      page: 1,\r\n      loading: false,\r\n      noMore: false,\r\n      scrollTop: 0\r\n    }\r\n  }, \r\n\r\n  onLoad(options) {\r\n    // 通过 eventChannel 接收数据\r\n    const eventChannel = this.getOpenerEventChannel()\r\n    eventChannel.on('acceptData', (data) => {\r\n      console.log('接收到数据:', data)  // 加日志验证，控制台会打印\r\n      this.friendId = Number(data.friendId) || 0\r\n      this.friendNickname = data.nickname || '聊天中'\r\n      this.friendAvatar = data.avatar || '/static/default-avatar.png'\r\n      \r\n      if (this.friendId === 0) {\r\n        uni.showToast({ title: '聊天对象错误', icon: 'none' })\r\n        return\r\n      }\r\n      \r\n      this.loadHistory()  // 加载历史消息\r\n    })\r\n    \r\n    // 强制更新 myId\r\n    const userInfo = uni.getStorageSync('userInfo')\r\n    console.log('存储的 userInfo:', userInfo)  // 加日志，控制台看是不是有 id\r\n  \r\n    this.myId = Number(userInfo?.id) || 0\r\n    \r\n    if (this.myId === 0) {\r\n      uni.showToast({ title: '请重新登录', icon: 'none' })\r\n      setTimeout(() => uni.navigateTo({ url: '/pages/login/login' }), 1500)\r\n      return\r\n    }\r\n  \r\n    console.log('更新后的 myId:', this.myId)  // 看是不是 0\r\n  },\r\n\r\n  onShow() {\r\n    // 进入聊天页 → 清除消息列表页的未读红点\r\n    this.clearUnreadBadge()\r\n    // 监听全局消息事件\r\n    uni.$on('newChatMessage', this.handleNewMessage)\r\n  },\r\n\r\n  onUnload() {\r\n    // 只移除监听，不关闭 socket\r\n    uni.$off('newChatMessage', this.handleNewMessage)\r\n  },\r\n\r\n  methods: {\r\n    // 返回\r\n    back() {\r\n      uni.navigateBack() \r\n    }, \r\n    // 处理收到的新消息\r\n// 3. 最关键：收到消息时先判断是不是自己发的临时消息（改 handleNewMessage）\r\n\thandleNewMessage(msg) {\r\n\t  // 如果这条消息是发给当前聊天对象的\r\n\t  if (msg.fromUserId === this.friendId || msg.toUserId === this.friendId) {\r\n\r\n\t\t// 情况1：找到一条临时消息（id 以 temp_ 开头），就替换它\r\n\t\tconst tempIndex = this.messages.findIndex(m => String(m.id).startsWith('temp_'))\r\n\t\tif (tempIndex > -1) {\r\n\t\t  this.messages.splice(tempIndex, 1, msg)  // 替换\r\n\t\t  return\r\n\t\t}\r\n\r\n\t\t// 情况2：没找到临时消息，且这条消息不是自己发的，才新增（防止别人给自己发消息也重复）\r\n\t\tif (msg.fromUserId !== this.myId) {\r\n\t\t  this.messages.push(msg)\r\n\t\t}\r\n\t\t// 如果是自己发的正式消息（后端推送回来），但没找到临时消息，也别重复加\r\n\t\t// （这种情况极少，几乎不会发生）\r\n\r\n\t\tthis.scrollToBottom()\r\n\t  }\r\n\t},\r\n\r\n\tsendText() {\r\n\t  if (!this.inputText.trim()) return\r\n\r\n\t  const msgObj = {\r\n\t\tfromUserId: this.myId,\r\n\t\ttoUserId: this.friendId,\r\n\t\tcontent: this.inputText.trim(),\r\n\t\ttype: 0\r\n\t  }\r\n\r\n\t  // 乐观更新：用一个固定前缀的临时ID\r\n\t  const tempId = 'temp_' + Date.now() + Math.random()\r\n\t  this.messages.push({\r\n\t\t...msgObj,\r\n\t\tid: tempId,\r\n\t\tcreateTime: new Date().toISOString()\r\n\t  })\r\n\t  this.scrollToBottom()\r\n\t  this.inputText = ''\r\n\r\n\t  // 真正发送\r\n\t  uni.sendSocketMessage({\r\n\t\tdata: JSON.stringify(msgObj),\r\n\t\tfail: () => {\r\n\t\t  uni.showToast({ title: '发送失败', icon: 'none' })\r\n\t\t  // 发送失败就把临时的那条删掉\r\n\t\t  const idx = this.messages.findIndex(m => m.id === tempId)\r\n\t\t  if (idx > -1) this.messages.splice(idx, 1)\r\n\t\t}\r\n\t  })\r\n\t},\r\n\r\n    // 选择并发送图片\r\n    chooseImage() {\r\n      uni.chooseImage({\r\n        count: 1,\r\n        sizeType: ['compressed'],\r\n        success: async (res) => {\r\n          const filePath = res.tempFilePaths[0] \r\n          uni.showLoading({ title: '发送中...' })\r\n\r\n          try {\r\n            const uploadRes = await uni.uploadFile({\r\n              url: 'http://192.168.0.105:8080/api/goods/upload',  // 统一 IP\r\n              filePath: filePath,\r\n              name: 'file',\r\n              header: {\r\n                Authorization: 'Bearer ' + uni.getStorageSync('token')\r\n              }\r\n            })\r\n\r\n            const result = JSON.parse(uploadRes.data)\r\n            if (result.url) {\r\n              const msg = {\r\n                fromUserId: this.myId,\r\n                toUserId: this.friendId,\r\n                imageUrl: result.url,\r\n                type: 1\r\n              }\r\n              this.sendMessage(msg)\r\n            } else {\r\n              uni.showToast({ title: '上传失败', icon: 'none' })\r\n            }\r\n          } catch (e) {\r\n            uni.showToast({ title: '发送失败', icon: 'none' })\r\n          } finally {\r\n            uni.hideLoading()\r\n          }\r\n        }\r\n      })\r\n    },\r\n\r\n    // 真正发送（WebSocket）\r\n  // 2. 发图片也一样（chooseImage 里调用 sendMessage 前加临时ID）\r\n\t  sendMessage(msgObj) {\r\n\t\tconst tempId = 'temp_' + Date.now() + Math.random()\r\n\t\tthis.messages.push({\r\n\t\t  ...msgObj,\r\n\t\t  id: tempId,\r\n\t\t  createTime: new Date().toISOString()\r\n\t\t})\r\n\t\tthis.scrollToBottom()\r\n\t  \r\n\t\tuni.sendSocketMessage({\r\n\t\t  data: JSON.stringify(msgObj),\r\n\t\t  fail: () => {\r\n\t\t\tconst idx = this.messages.findIndex(m => m.id === tempId)\r\n\t\t\tif (idx > -1) this.messages.splice(idx, 1)\r\n\t\t  }\r\n\t\t})\r\n\t  },\r\n\r\n    loadHistory() {\r\n      if (this.loading || this.noMore) return\r\n      this.loading = true\r\n\r\n      const token = uni.getStorageSync('token')\r\n      if (!token) {\r\n        uni.showToast({ title: '请重新登录', icon: 'none' })\r\n        this.loading = false\r\n        return\r\n      }\r\n\r\n      uni.request({\r\n        url: 'http://192.168.0.105:8080/api/chat/history',  // 统一 IP\r\n        method: 'GET',\r\n        data: {\r\n          friendId: this.friendId,\r\n          page: this.page,\r\n          size: 30\r\n        },\r\n        header: {\r\n          Authorization: 'Bearer ' + token\r\n        },\r\n        success: (res) => {\r\n          if (res.data && res.data.list) {\r\n            const list = res.data.list.reverse()\r\n            this.messages.unshift(...list)\r\n\r\n            if (list.length < 30) this.noMore = true\r\n            this.page++\r\n\r\n            if (this.page === 2) {\r\n              this.$nextTick(() => this.scrollToBottom())\r\n            }\r\n          }\r\n        },\r\n        fail: (err) => {\r\n          console.error('加载失败', err)\r\n          uni.showToast({ title: '加载失败，请检查网络', icon: 'none' })\r\n        },\r\n        complete: () => {\r\n          this.loading = false\r\n        }\r\n      })\r\n    },\r\n\r\n    // 上拉加载更多\r\n    loadMore() {\r\n      if (!this.loading && !this.noMore) {\r\n        this.loadHistory()\r\n      }\r\n    },\r\n\r\n    // 滚动到底部\r\n    scrollToBottom() {\r\n      this.$nextTick(() => {\r\n        this.scrollTop = 999999\r\n      })\r\n    },\r\n\r\n    // 预览图片\r\n    previewImage(url) {\r\n      uni.previewImage({\r\n        urls: [url],\r\n        current: url\r\n      })\r\n    },\r\n\r\n    // 清除消息列表页的未读红点（优雅实现）\r\n    clearUnreadBadge() {\r\n      try {\r\n        const pages = getCurrentPages()\r\n        if (pages.length < 2) return\r\n        const prevPage = pages[pages.length - 2]\r\n        if (!prevPage || prevPage.route !== 'pages/chat-list/chat-list') return\r\n        if (!prevPage.sessions || !Array.isArray(prevPage.sessions)) return\r\n\r\n        const session = prevPage.sessions.find(s => Number(s.friendId) === Number(this.friendId))\r\n        if (session) session.unread = 0\r\n      } catch (e) {\r\n        console.log('清除未读失败，无需处理', e)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.chat-page { height: 100vh; display: flex; flex-direction: column; background: #f5f5f5; }\r\n\r\n.navbar {\r\n  height: 90rpx;\r\n  background: linear-gradient(135deg, #667eea, #764ba2);\r\n  color: #fff;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 0 30rpx;\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  z-index: 1000;\r\n  padding-top: var(--status-bar-height);\r\n}\r\n.title { font-size: 36rpx; font-weight: bold; }\r\n\r\n.msg-list {\r\n  flex: 1;\r\n  padding: 20rpx 30rpx 140rpx;\r\n  padding-top: 110rpx;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.msg-item {\r\n  display: flex;\r\n  margin-bottom: 40rpx;\r\n  align-items: flex-end;\r\n}\r\n.msg-item.mine { flex-direction: row-reverse; }\r\n\r\n.avatar {\r\n  width: 88rpx;\r\n  height: 88rpx;\r\n  border-radius: 50%;\r\n  background: #fff;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.bubble {\r\n  max-width: 540rpx;\r\n  margin: 0 20rpx;\r\n  padding: 20rpx 28rpx;\r\n  border-radius: 30rpx;\r\n  position: relative;\r\n  word-break: break-all;\r\n  line-height: 1.5;\r\n}\r\n.other-bubble {\r\n  background: #fff;\r\n  border-bottom-left-radius: 6rpx;\r\n}\r\n.my-bubble {\r\n  background: #95ec69;\r\n  border-bottom-right-radius: 6rpx;\r\n}\r\n.msg-text { font-size: 32rpx; }\r\n.msg-image { max-width: 400rpx; border-radius: 20rpx; }\r\n\r\n.input-bar {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 100rpx;\r\n  background: #fff;\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 0 20rpx;\r\n  border-top: 1px solid #eee;\r\n  box-sizing: border-box;\r\n}\r\n.input {\r\n  flex: 1;\r\n  height: 70rpx;\r\n  background: #f5f5f5;\r\n  border-radius: 35rpx;\r\n  padding: 0 30rpx;\r\n  font-size: 32rpx;\r\n}\r\n.icon-btn { padding: 0 20rpx; }\r\n.send-btn {\r\n  width: 120rpx;\r\n  height: 70rpx;\r\n  line-height: 70rpx;\r\n  padding: 0;\r\n  font-size: 32rpx;\r\n  background: #ddd;\r\n  color: #999;\r\n  border-radius: 35rpx;\r\n  margin-left: 20rpx;\r\n}\r\n.send-btn.active {\r\n  background: #007AFF;\r\n  color: #fff;\r\n}\r\n\r\n.loading-tip {\r\n  text-align: center;\r\n  padding: 20rpx;\r\n  color: #999;\r\n  font-size: 28rpx;\r\n}\r\n</style>","import MiniProgramPage from 'E:/code/wechatDOC/HbUniapp/demoxiaoyuan/pages/chat/chat.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}